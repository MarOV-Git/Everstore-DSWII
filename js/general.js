$(()=>{$("#btnAdd").click(function(a){a.preventDefault()}),$(".tooltipped").tooltip({delay:50}),firebase.initializeApp(firebaseConfig),this.db=firebase.firestore();this.db.settings({timestampsInSnapshots:!0});const a=new Crud;a.consultarRecientes(),a.consultarTodosItems(),a.consultarXcategoria("Acción"),a.consultarXcategoria("Terror"),a.consultarXcategoria("Drama"),a.consultarXcategoria("Fantasía");firebase.auth().onAuthStateChanged(e=>{if(e){if(this.db.collection("usuarios").where("email","==",e.email).where("tipo","==","Admin").get().then(a=>{a.docs.length>0?(console.log("Es admin"),$("#mantSec").removeClass("d-none"),owo="owo"):(console.log("No es admin"),$("#mantSec").addClass("d-none"))}),e.displayName){$("#unlog").addClass("d-none"),$("#logued").removeClass("d-none"),$("#user-name").html(`<i class="fa fa-user-o lf"></i><span data-email="${e.email}" id="name-val" class="name-val">${e.displayName}</span>`),a.consultarCarrito(`${e.email}`);$("#misCategorias").attr("data-micategoria");a.consultarMisLibros(`${e.email}`,"Todos")}$("#avatar").removeClass("d-none"),e.photoURL?$("#avatar").attr("src",e.photoURL):$("#avatar").attr("src","img/usuario_auth.png")}else $("#btnInicioSesion1").html("Iniciar Sesión"),$("#btnInicioSesion2").html("Iniciar Sesión"),$("#mantenimiento").addClass("d-none"),$("#avatar").addClass("d-none"),$(document).ready(function(){$("#loginModal").modal("show")})}),$("form").submit(function(a){a.preventDefault()}),$("#btnInicioSesion").click(()=>{if(firebase.auth().currentUser)return $("#btnInicioSesion1").text("Iniciar Sesión"),firebase.auth().signOut().then(()=>{alert("SignOut correcto"),window.setTimeout(function(){window.location.href="index.html"},500)}).catch(a=>{alert(`Error al realizar SignOut => ${a}`)});$("#emailSesion").val(""),$("#passwordSesion").val(""),$("#modalSesion").modal("show")}),$("#btnInicioSesion2").click(()=>{if(firebase.auth().currentUser)return $("#btnInicioSesion1").text("Iniciar Sesión"),firebase.auth().signOut().then(()=>{$("#avatar").attr("src","img/usuario.png"),alert("SignOut correcto"),window.setTimeout(function(){window.location.href="index.html"},500)}).catch(a=>{alert(`Error al realizar SignOut => ${a}`)});$("#emailSesion").val(""),$("#passwordSesion").val(""),$("#modalSesion").modal("show")}),$("#btn-logout").click(()=>{const a=$("#name-val").html();firebase.auth().signOut().then(()=>{Swal.fire({title:"¡Adios!",text:`Hasta la proxima ${a}`,imageUrl:"img/bye.png",imageWidth:400,imageAlt:"Custom image"}),window.setTimeout(function(){window.location.href="index.html"},1500)}).catch(a=>{Swal.fire({icon:"error",title:"Oops...",text:`Ocurrió un problema al realizar el SignOut ${a}`})})})});
